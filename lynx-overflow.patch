--- lynx2-8-2/src/LYMail.c.over	Thu May  6 02:33:59 1999
+++ lynx2-8-2/src/LYMail.c	Tue May 11 14:53:14 1999
@@ -311,7 +311,7 @@
      *	entry, if permitted. - FM
      */
     if (!LYNoCc) {
-	sprintf(self, "%.79s", (personal_mail_address ?
+	snprintf(self, 80, "%.79s", (personal_mail_address ?
 				personal_mail_address : ""));
 	self[79] = '\0';
 	_statusline("Cc: ");
@@ -382,7 +382,7 @@
 #endif
 
 #else
-    sprintf(cmd, "%s %s", system_mail, system_mail_flags);
+    snprintf(cmd, sizeof(cmd), "%s %s", system_mail, system_mail_flags);
     if ((fd = popen(cmd, "w")) == NULL) {
 	HTAlert(FORM_MAILTO_FAILED);
 	FREE(address);
@@ -461,7 +461,7 @@
 	/*
 	 *  Now set up the command. - FM
 	 */
-	sprintf(cmd,
+	snprintf(cmd, sizeof(cmd), 
 		"%s %s %s,%s ",
 		system_mail,
 		system_mail_flags,
@@ -476,7 +476,7 @@
 	 *
 	 *  Possibly still a problem if user supplies long subject. - BL
 	 */
-	sprintf(cmd,
+	snprintf(cmd, sizeof(cmd), 
 		"%s %s%s/subject=\"%s\" %s ",
 		system_mail,
 		system_mail_flags,
@@ -511,7 +511,7 @@
 	    if (!first) {
 		StrAllocCat(command, ",");
 	    }
-	    sprintf(cmd, mail_adrs, address_ptr1);
+	    snprintf(cmd, sizeof(cmd),  mail_adrs, address_ptr1);
 	    StrAllocCat(command, cmd);
 	    first = FALSE;
 	}
@@ -542,7 +542,7 @@
 	    if (strlen(address_ptr1) > 3 &&
 		strlen(address_ptr1) + strlen(mail_adrs) < sizeof(cmd)) {
 		StrAllocCat(command, ",");
-		sprintf(cmd, mail_adrs, address_ptr1);
+		snprintf(cmd, sizeof(cmd), mail_adrs, address_ptr1);
 		if (isPMDF) {
 		    strcat(cmd, "/CC");
 		}
@@ -1097,7 +1097,7 @@
 				i += 78;
 				len = strlen((char *)&cp0[i]);
 			    }
-			    sprintf(cmd, "%s\n", (char *)&cp0[i]);
+			    snprintf(cmd,sizeof(cmd), "%s\n", (char *)&cp0[i]);
 			    StrAllocCat(body, cmd);
 			    cp0 = (cp + 1);
 			}
@@ -1112,7 +1112,7 @@
 			    len = strlen((char *)&cp0[i]);
 			}
 			if (len) {
-			    sprintf(cmd, "%s\n", (char *)&cp0[i]);
+			    snprintf(cmd,sizeof(cmd), "%s\n", (char *)&cp0[i]);
 			    StrAllocCat(body, cmd);
 			}
 			FREE(temp);
@@ -1244,7 +1244,7 @@
 	if (!LYHaveCJKCharacterSet &&
 	    strncasecomp(LYCharSet_UC[current_char_set].MIMEname, "x-", 2)
 	    != 0) {
-	    sprintf(buf,"Content-Type: text/plain; charset=%s\n",
+	    snprintf(buf, sizeof(buf),"Content-Type: text/plain; charset=%s\n",
 		    LYCharSet_UC[current_char_set].MIMEname);
 	    StrAllocCat(header, buf);
 	}
@@ -1262,7 +1262,7 @@
 	StrAllocCat(header, address);
     }
     StrAllocCat(header, "\n");
-    sprintf(buf, "X-Mailer: Lynx, Version %s\n", LYNX_VERSION);
+    snprintf(buf, sizeof(buf), "X-Mailer: Lynx, Version %s\n", LYNX_VERSION);
     StrAllocCat(header, buf);
 
     if (refid && *refid) {
@@ -1389,7 +1389,7 @@
     addstr("From: ");
 #endif /* VMS */
     /* Add the personal mail address if there is one. */
-    sprintf(user_input, "%s", (personal_mail_address ?
+    snprintf(user_input, sizeof(user_input), "%s", (personal_mail_address ?
 			       personal_mail_address : ""));
     if (LYgetstr(user_input, VISIBLE, sizeof(user_input), NORECALL) < 0 ||
 	term_letter) {
@@ -1428,7 +1428,7 @@
     addstr(CTRL_U_TO_ERASE);
     addstr(SUBJECT_PROMPT);
     /* Add the default subject. */
-    sprintf(user_input, "%.70s%.63s",
+    snprintf(user_input, sizeof(user_input), "%.70s%.63s",
 			(subject[0] != '\0') ?
 				     subject :
 		    ((filename && *filename) ?
@@ -1448,7 +1448,7 @@
     addstr("\n");
     remove_tildes(user_input);
 #ifdef VMS
-    sprintf(subject, "%.70s", user_input);
+    snprintf(subject, sizeof(subject), "%.70s", user_input);
 #else
     StrAllocCat(header, "Subject: ");
     StrAllocCat(header, user_input);
@@ -1468,7 +1468,7 @@
 	/*
 	 *  Add the mail address if there is one.
 	 */
-	sprintf(user_input, "%s", (personal_mail_address ?
+	snprintf(user_input, sizeof(user_input), "%s", (personal_mail_address ?
 				   personal_mail_address : ""));
 	if (LYgetstr(user_input, VISIBLE, sizeof(user_input), NORECALL) < 0 ||
 	    term_letter) {
@@ -1526,7 +1526,7 @@
     /*
      *	Terminate the header.
      */
-    sprintf(buf, "\n");
+    snprintf(buf, sizeof(buf), "\n");
     StrAllocCat(header, buf);
     CTRACE(tfp,"**header==\n%s",header);
 #endif /* !VMS */
@@ -1574,7 +1574,7 @@
 	if (strstr(editor, "pico")) {
 	    editor_arg = " -t"; /* No prompt for filename to use */
 	}
-	sprintf(user_input, "%s%s %s", editor, editor_arg, my_tmpfile);
+	snprintf(user_input, sizeof(user_input), "%s%s %s", editor, editor_arg, my_tmpfile);
 	_statusline(SPAWNING_EDITOR_FOR_MAIL);
 	stop_curses();
 	if (LYSystem(user_input)) {
@@ -1721,7 +1721,7 @@
 	/*
 	 *  Now set up the command. - FM
 	 */
-	sprintf(cmd,
+	snprintf(cmd, sizeof(cmd), 
 		"%s %s %s,%s ",
 		system_mail,
 		system_mail_flags,
@@ -1736,7 +1736,7 @@
 	 *
 	 *  Possibly still a problem if user supplies long subject. - BL
 	 */
-	sprintf(cmd,
+	snprintf(cmd, sizeof(cmd),
 		"%s %s%s/subject=\"%s\" %s ",
 		system_mail,
 		system_mail_flags,
@@ -1771,7 +1771,7 @@
 	    if (!first) {
 		StrAllocCat(command, ",");
 	    }
-	    sprintf(cmd, mail_adrs, address_ptr1);
+	    snprintf(cmd, sizeof(cmd), mail_adrs, address_ptr1);
 	    StrAllocCat(command, cmd);
 	    first = FALSE;
 	}
@@ -1802,7 +1802,7 @@
 	    if (strlen(address_ptr1) > 3 &&
 		strlen(address_ptr1) + strlen(mail_adrs) < sizeof(cmd)) {
 		StrAllocCat(command, ",");
-		sprintf(cmd, mail_adrs, address_ptr1);
+		snprintf(cmd, sizeof(cmd), mail_adrs, address_ptr1);
 		if (isPMDF) {
 		    strcat(cmd, "/CC");
 		}
@@ -1824,7 +1824,7 @@
      *	Send the tmpfile into sendmail.
      */
     _statusline(SENDING_YOUR_MSG);
-    sprintf(cmd, "%s %s", system_mail, system_mail_flags);
+    snprintf(cmd, sizeof(cmd), "%s %s", system_mail, system_mail_flags);
 #ifdef DOSPATH
     if ((fp = LYOpenTemp(tmpfile2, ".txt", "w")) == NULL) {
 	HTAlert(MAILTO_URL_TEMPOPEN_FAILED);
